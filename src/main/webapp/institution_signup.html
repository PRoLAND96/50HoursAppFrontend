<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Munkáltató Regisztráció</title>
    <link rel="stylesheet" href="css/institution_login.css">
</head>
<body>
<div class="login-container">
    <div class="header">
        <h2>Regisztráció</h2>
    </div>
    <div class="inside-container">
        <h3>Intézmény</h3>
        <form id="registerForm" action="javascript:void(0)" method="post">
            <div class="form-group">
                <label for="schoolName">Intézmény neve:</label>
                <input type="text" id="schoolName" name="schoolName" required>
            </div>
            <div class="form-group">
                <label for="jobType">Munkakör típusa:</label>
                <select style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; background-color: #c8d8e8;"id="jobType" name="jobType" required>
                    <!-- Dinamikusan generált munkakör típusok -->
                </select>
            </div>
            <div class="form-group">
                <label for="location">Cím:</label>
                <input type="text" id="location" name="location" required>
            </div>
            <div class="form-group">
                <label for="descriptionText">Leírás szövege:</label>
                <textarea style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; background-color: #c8d8e8;" id="descriptionText" name="descriptionText" rows="4" required></textarea>
            </div>
            <div class="form-group">
                <label for="links">Linkek:</label>
                <input type="text" id="links" name="links" required>
            </div>
            <div class="form-group">
                <label for="pictures">Képek:</label>
                <input type="text" id="pictures" name="pictures" required>
            </div>
            <button type="button" class="button" onclick="submitRegisterForm()">Regisztráció</button>
        </form>
        <p>Már van fiókod? <a href="institution_login.html">Jelentkezz be!</a></p>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        fetch('http://localhost:8080/jobTypes', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                const jobTypeSelect = document.getElementById('jobType');

                data.forEach(jobType => {
                    const option = document.createElement('option');
                    option.value = jobType.name;
                    option.textContent = jobType.name;
                    jobTypeSelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error('Error fetching job types:', error);
            });
    });

    function submitRegisterForm() {
        var schoolName = document.getElementById('schoolName').value;
        var jobType = document.getElementById('jobType').value;
        var location = document.getElementById('location').value;
        var descriptionText = document.getElementById('descriptionText').value;
        var links = document.getElementById('links').value.split(',');
        var pictures = document.getElementById('pictures').value.split(',');

        var registerData = {
            "name": schoolName,
            "type": jobType,
            "location": location,
            "description": {
                "text": descriptionText,
                "links": links,
                "pictures": pictures
            }
        };

        fetch('http://localhost:8080/institution', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(registerData)
        })
            .then(function(response) {
                if (response.ok) {
                    alert("Sikeres regisztráció.")
                }
                throw new Error('Network response was not ok.');
            })
            .catch(function(error) {
                alert("Hiba történt a regisztráció során: " + error.message);
            });
    }
</script>
</body>
</html>
