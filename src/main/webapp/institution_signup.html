<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Munkáltató Regisztráció</title>
    <link rel="stylesheet" href="css/institution_login.css">
</head>
<body>
<div class="login-container">
    <div class="header">
        <h2>Regisztráció</h2>
    </div>
    <div class="inside-container">
        <h3>Intézmény</h3>
        <form id="registerForm" action="javascript:void(0)" method="post">
            <div class="form-group">
                <label for="name">Intézmény neve:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="type">Munkakör típusa:</label>
                <select style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; background-color: #c8d8e8;" id="type" name="type" required>
                    <!-- Dinamikusan generált munkakör típusok -->
                </select>
            </div>
            <div class="form-group">
                <label for="location">Cím:</label>
                <input type="text" id="location" name="location" required>
            </div>
            <div class="form-group">
                <label for="text">Leírás szövege:</label>
                <textarea style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; background-color: #c8d8e8;" id="text" name="text" rows="4" required></textarea>
            </div>
            <div class="form-group">
                <label for="links">Linkek:</label>
                <input type="text" id="links" name="links" required>
            </div>
            <div class="form-group">
                <label for="pictures">Képek:</label>
                <input type="text" id="pictures" name="pictures" required>
            </div>
            <button type="button" class="button" onclick="submitRegisterForm()">Regisztráció</button>
        </form>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        fetch('http://localhost:8080/jobTypes', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                const jobTypeSelect = document.getElementById('jobType');

                data.forEach(jobType => {
                    const option = document.createElement('option');
                    option.value = jobType.name;
                    option.textContent = jobType.name;
                    jobTypeSelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error('Error fetching job types:', error);
            });
    });

    function submitRegisterForm() {
        var name = document.getElementById('name').value;
        var type = document.getElementById('type').value;
        var location = document.getElementById('location').value;
        var text = document.getElementById('text').value;
        var links = document.getElementById('links').value.split(',');
        var pictures = document.getElementById('pictures').value.split(',');

        var registerData = {
            "name": name,
            "type": type,
            "location": location,
            "description": {
                "text": text,
                "links": links,
                "pictures": pictures
            }
        };

        fetch('http://localhost:8080/institution', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(registerData)
        })
            .then(function(response) {
                if (response.ok) {
                    alert("Sikeres regisztráció.")
                }
                throw new Error('Network response was not ok.');
            })
            .catch(function(error) {
                alert("Hiba történt a regisztráció során: " + error.message);
            });
    }
</script>
</body>
</html>
